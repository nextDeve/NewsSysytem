{"version":3,"file":"static/js/352.d3b6d379.chunk.js","mappings":"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","sources":["components/NewsEditer/index.jsx","views/NewsSandBox/news-manage/NewsUpdate/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Editor } from \"react-draft-wysiwyg\";\r\nimport { convertToRaw, EditorState, ContentState } from 'draft-js';\r\nimport draftToHtml from 'draftjs-to-html';\r\nimport htmlToDraft from 'html-to-draftjs';\r\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\r\nimport './index.css'\r\nfunction NewsEditer(props) {\r\n    const [editorState, setEditorState] = useState(EditorState.createEmpty())\r\n    useEffect(() => {\r\n        if (props.content) {\r\n            const contentBlock = htmlToDraft(props.content)\r\n            const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks)\r\n            const editState = EditorState.createWithContent(contentState)\r\n            setEditorState(editState)\r\n        }\r\n    }, [props.content])\r\n    return (\r\n        <Editor\r\n            editorState={editorState}\r\n            wrapperClassName=\"wrapper-editer\"\r\n            editorClassName=\"editor\"\r\n            onEditorStateChange={(editorState) => setEditorState(editorState)}\r\n            onBlur={() => {\r\n                props.getContent(draftToHtml(convertToRaw(editorState.getCurrentContent())))\r\n            }}\r\n        />\r\n    )\r\n}\r\nexport default NewsEditer","import React, { useEffect, useState, createRef } from 'react'\r\nimport { PageHeader, Steps, Button, Form, Input, Select, message, notification } from 'antd';\r\nimport axios from 'axios';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport NewsEditer from '../../../../components/NewsEditer';\r\nconst { Step } = Steps;\r\nconst { Option } = Select\r\nexport default function NewsUpdate() {\r\n    let [current, setCurrent] = useState(0);\r\n    let location = useLocation()\r\n    let [categories, setCategories] = useState([]);\r\n    let [news, setNews] = useState(location.state)\r\n    let form1Ref = createRef()\r\n    let navigate = useNavigate()\r\n\r\n    useEffect(() => {\r\n        axios.get('/api/getCategories').then((res) => {\r\n            setCategories(res.data)\r\n        })\r\n    }, [])\r\n\r\n    const handleNext = () => {\r\n        if (current === 0) {\r\n            form1Ref.current.validateFields().then((value) => {\r\n                setNews({ ...news, ...value })\r\n                setCurrent(current + 1)\r\n            }).catch(() => { console.log('error') })\r\n        } else {\r\n            if (news.content === '' || news.content.trim() === '<p></p>') {\r\n                message.error('新闻内容不能为空！')\r\n            }\r\n            else setCurrent(current + 1)\r\n        }\r\n    }\r\n    const handlePrevious = () => {\r\n        setCurrent(current - 1)\r\n    }\r\n    const handleSave = (state) => {\r\n        axios.post('/api/updateNews', { ...news, auditState: state }).then(() => {\r\n            notification.info({\r\n                message: '提交/保存成功！',\r\n                placement: 'topRight',\r\n            });\r\n            navigate(state === 0 ? '/news-manage/draft' : '/audit-manage/list')\r\n        })\r\n    }\r\n    const layout = {\r\n        labelCol: { span: 3 },\r\n        wrapperCol: { span: 21 },\r\n    };\r\n    return (\r\n        <div>\r\n            <PageHeader\r\n                className=\"site-page-header\"\r\n                title=\"撰写新闻\"\r\n            />\r\n            <Steps current={current}>\r\n                <Step title=\"基本信息\" description=\"新闻标题，新闻分类\" />\r\n                <Step title=\"新闻主体\" description=\"新闻主题内容\" />\r\n                <Step title=\"新闻提交\" description=\"保存草稿或提交审核\" />\r\n            </Steps>\r\n            <div style={{ display: current === 0 ? 'block' : 'none', marginTop: '20px' }}>\r\n                <Form {...layout} ref={form1Ref} initialValues={news}>\r\n                    <Form.Item label=\"新闻标题\" name=\"title\" rules={[{ required: true, message: '请输入标题！' }]} >\r\n                        <Input />\r\n                    </Form.Item>\r\n\r\n                    <Form.Item label=\"新闻分类\" name=\"categoryId\" rules={[{ required: true, message: '请选择新闻分类' }]}>\r\n                        <Select >\r\n                            {categories.map((item) => <Option value={item.id} key={item.id}>{item.title}</Option>)}\r\n                        </Select>\r\n                    </Form.Item>\r\n                </Form>\r\n            </div>\r\n            <div style={{ display: current === 1 ? 'block' : 'none', marginTop: '20px', height: '350px' }}>\r\n                <NewsEditer getContent={(value) => { setNews({ ...news, content: value }) }}\r\n                    content={news.content}\r\n                >\r\n                </NewsEditer>\r\n            </div>\r\n            <div style={{ display: current === 2 ? 'block' : 'none' }}></div>\r\n            <div style={{ marginTop: '80px', }}>\r\n                {\r\n                    current < 2 && <Button type='primary' onClick={handleNext}>下一步</Button>\r\n                }\r\n                {\r\n                    current === 2 && <Button type='primary' onClick={() => { handleSave(0) }}>保存草稿</Button>\r\n                }\r\n                {\r\n                    current === 2 && <Button type='danger' onClick={() => { handleSave(1) }}>提交审核</Button>\r\n                }\r\n                {\r\n                    current > 0 && <Button onClick={handlePrevious}>上一步</Button>\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"names":["props","useState","EditorState","editorState","setEditorState","useEffect","content","contentBlock","htmlToDraft","contentState","ContentState","contentBlocks","editState","Editor","wrapperClassName","editorClassName","onEditorStateChange","onBlur","getContent","draftToHtml","convertToRaw","getCurrentContent","Step","Steps","Option","Select","NewsUpdate","current","setCurrent","location","useLocation","categories","setCategories","state","news","setNews","form1Ref","createRef","navigate","useNavigate","axios","then","res","data","handleSave","auditState","notification","message","placement","className","title","description","style","display","marginTop","labelCol","span","wrapperCol","ref","initialValues","label","name","rules","required","map","item","value","id","height","type","onClick","validateFields","catch","console","log","trim"],"sourceRoot":""}